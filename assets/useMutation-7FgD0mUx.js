import{d as t}from"./compiler-runtime-lZCNVxYm.js";import{r as e,e as s,R as r,w as n,S as i,x as a,av as u,aw as o,K as c,M as h,z as l,L as p}from"./index-hyz1gGYG.js";function d(){return d=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},d.apply(this,arguments)}const m=e.forwardRef((r,n)=>{const{prefixCls:i="rc-checkbox",className:a,style:u,checked:o,disabled:c,defaultChecked:h=!1,type:l="checkbox",title:p,onChange:m,...f}=r,b=e.useRef(null),y=e.useRef(null),[v,O]=t(h,o);e.useImperativeHandle(n,()=>({focus:t=>{b.current?.focus(t)},blur:()=>{b.current?.blur()},input:b.current,nativeElement:y.current}));const g=s(i,a,{[`${i}-checked`]:v,[`${i}-disabled`]:c});return e.createElement("span",{className:g,title:p,style:u,ref:y},e.createElement("input",d({},f,{className:`${i}-input`,ref:b,onChange:t=>{c||("checked"in r||O(t.target.checked),m?.({target:{...r,type:l,checked:t.target.checked},stopPropagation(){t.stopPropagation()},preventDefault(){t.preventDefault()},nativeEvent:t.nativeEvent}))},disabled:c,checked:!!v,type:l})),e.createElement("span",{className:`${i}-inner`}))});function f(t){const e=r.useRef(null),s=()=>{n.cancel(e.current),e.current=null};return[()=>{s(),e.current=n(()=>{e.current=null})},r=>{e.current&&(r.stopPropagation(),s()),t?.(r)}]}var b=class extends i{#t;#e=void 0;#s;#r;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),a(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&u(e.mutationKey)!==u(this.options.mutationKey)?this.reset():"pending"===this.#s?.state.status&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#n(),this.#i(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#n(),this.#i()}mutate(t,e){return this.#r=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#n(){const t=this.#s?.state??o();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#i(t){c.batch(()=>{if(this.#r&&this.hasListeners()){const s=this.#e.variables,r=this.#e.context,n={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if("success"===t?.type){try{this.#r.onSuccess?.(t.data,s,r,n)}catch(e){Promise.reject(e)}try{this.#r.onSettled?.(t.data,null,s,r,n)}catch(e){Promise.reject(e)}}else if("error"===t?.type){try{this.#r.onError?.(t.error,s,r,n)}catch(e){Promise.reject(e)}try{this.#r.onSettled?.(void 0,t.error,s,r,n)}catch(e){Promise.reject(e)}}}this.listeners.forEach(t=>{t(this.#e)})})}};function y(t,s){const r=h(),[n]=e.useState(()=>new b(r,t));e.useEffect(()=>{n.setOptions(t)},[n,t]);const i=e.useSyncExternalStore(e.useCallback(t=>n.subscribe(c.batchCalls(t)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),a=e.useCallback((t,e)=>{n.mutate(t,e).catch(l)},[n]);if(i.error&&p(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}export{m as C,y as a,f as u};
