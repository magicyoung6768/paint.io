import{r as e,d as t,w as r,R as a,e as s,f as n,g as i,h as o,k as l,l as c,m,n as d,o as h,b as u,a as p,j as g}from"./index-hyz1gGYG.js";import{I as f,_ as y,g as v,u as x,a as _,c as b}from"./compiler-runtime-lZCNVxYm.js";import{u as N,C as w,R as k}from"./homeStore-DjyE_MAz.js";import{Q as C,b as j,a as S,u as P}from"./useRequestManager-C9iD_Irj.js";import{S as E}from"./index-CrA54tPP.js";import{B as R}from"./http-B5jRIb2e.js";import{i as O,R as M,T as z,I as $}from"./ImageDetail-CJ3Mu_X8.js";import{R as L}from"./DownloadOutlined-rLzdGP5V.js";import{A as I}from"./index-BTvPzMEN.js";import{R as F}from"./UserOutlined-mPFKaYNg.js";import{C as D}from"./CSSMotionList-ItMlH75q.js";import{u as H,r as q}from"./useBreakpoint-D29ngWH8.js";import{u as A}from"./useGutter-CRvBSych.js";import{S as B}from"./index-LJbI4l_G.js";import"./index-D6R1AH5w.js";import{R as T}from"./SearchOutlined-Dpmd1bWW.js";import{R as K}from"./Dropdown-DQiDk8Wd.js";import{R as U}from"./PlusOutlined-CsPGWXwT.js";import{D as G}from"./index-BBQFmD6n.js";import{R as J}from"./PictureOutlined-BMhCH_9F.js";import{R as V}from"./SettingOutlined-V92_LJBI.js";import{M as Q}from"./index-D8tAwSqP.js";import"./index-CZ7IBIeE.js";import"./index-usiDD4Rt.js";import"./EllipsisOutlined-DspTKZvB.js";import"./collapse-BIO5DT9H.js";import"./RightOutlined-KLmSG3Aj.js";import"./statusUtils-D7MEQEAE.js";import"./index-NBHuT0Pn.js";import"./index-B6lbc1vE.js";import"./index-BkGCWn1F.js";import"./index-BPnexpEk.js";var W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"};function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},X.apply(this,arguments)}const Y=(t,r)=>e.createElement(f,X({},t,{ref:r,icon:W})),Z=e.forwardRef(Y);var ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"};function te(){return te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},te.apply(this,arguments)}const re=(t,r)=>e.createElement(f,te({},t,{ref:r,icon:ee})),ae=e.forwardRef(re);var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"};function ne(){return ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ne.apply(this,arguments)}const ie=(t,r)=>e.createElement(f,ne({},t,{ref:r,icon:se})),oe=e.forwardRef(ie);var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ce.apply(this,arguments)}const me=(t,r)=>e.createElement(f,ce({},t,{ref:r,icon:le})),de=e.forwardRef(me);const he=a.forwardRef((t,r)=>{const{item:i,style:o,prefixCls:l,itemRender:c,className:m,index:d,column:h,onResize:u}=t,p=`${l}-item`,g=e.useMemo(()=>i.children??c?.({...i,index:d,column:h}),[i,c,h,d]);let f=a.createElement("div",{ref:r,style:o,className:s(p,m)},g);return u&&(f=a.createElement(n,{onResize:u},f)),f}),ue=e=>{const{componentCls:t}=e,r=`${t}-item`;return{[t]:{position:"relative",boxSizing:"border-box",display:"flex",flexDirection:"column",flexWrap:"wrap","&-rtl":{direction:"rtl"},[`& > ${r}`]:{boxSizing:"border-box","&-fade":{"&-appear":{transition:`opacity ${e.motionDurationSlow} ${e.motionEaseOut}`,opacity:0,"&-active":{opacity:1}},"&-leave":{transition:`opacity ${e.motionDurationFast} ${e.motionEaseOut}`,opacity:1,"&-active":{opacity:0}}},[`&:not(${r}-fade)`]:{transition:["left","right","top"].map(t=>`${t} ${e.motionDurationSlow} ${e.motionEaseOut}`).join(",")}}}}},pe=v("Masonry",e=>[ue(e)]),ge=e.forwardRef((a,m)=>{const{rootClassName:d,className:h,style:u,classNames:p,styles:g,columns:f,prefixCls:v,gutter:b=0,items:N,itemRender:w,onLayoutChange:k,fresh:C}=a,{getPrefixCls:j,direction:S,className:P,style:E,classNames:R,styles:O}=i("masonry"),M=j("masonry",v),z=x(M),[$,L]=pe(M,z),I=e.useRef(null);e.useImperativeHandle(m,()=>({nativeElement:I.current}));const[F,B]=function(){const t=e.useRef(null);return null===t.current&&(t.current=new Map),[(e,r)=>{t.current.set(e,r)},e=>t.current.get(e)]}(),[T,K]=e.useState([]);e.useEffect(()=>{K(N||[])},[N]);const U=H(),G=A(b,U),[J=0,V=J]=G,Q=e.useMemo(()=>{if(!f)return 3;if("number"==typeof f)return f;const e=q.find(e=>U[e]&&void 0!==f[e]);return e?f[e]:f.xs??1},[f,U]),W={...a,columns:Q},[X,Y]=_([R,p],[O,g],{props:W}),[Z,ee]=e.useState([]),te=function(a){const s=e.useRef(0),n=()=>{r.cancel(s.current)};return e.useEffect(()=>n,[]),t(()=>{n(),s.current=r(a)})}(()=>{const e=T.map((e,t)=>{const r=e.key??t,a=B(r),s=a?.getBoundingClientRect();return[r,s?s.height:0,e.column]});ee(t=>l(t,e)?t:e)}),[re,ae]=function(t,r,a){const[s,n]=e.useMemo(()=>{const e=new Array(r).fill(0),s=new Map;for(let n=0;n<t.length;n+=1){const[i,o,l]=t[n];let c=l??e.indexOf(Math.min.apply(Math,y(e)));c=Math.min(c,r-1);const m=e[c];s.set(i,{column:c,top:m}),e[c]+=o+a}return[s,Math.max(0,Math.max.apply(Math,y(e))-a)]},[r,t,a]);return[s,n]}(Z,Q,V),se=e.useMemo(()=>T.map((e,t)=>{const r=e.key??t;return{item:e,itemIndex:t,itemKey:r,key:r,position:re.get(r)}}),[T,re]);e.useEffect(()=>{te()},[T,Q]);const[ne,ie]=e.useState([]);return o(()=>{k&&se.every(({position:e})=>e)&&ie(e=>{const t=se.map(({item:e,position:t})=>[e,t.column]);return l(e,t)?e:t})},[se]),o(()=>{k&&N&&N.length===ne.length&&k(ne.map(([e,t])=>({...e,column:t})))},[ne]),e.createElement(n,{onResize:te},e.createElement("div",{ref:I,className:s(M,P,X.root,d,h,$,L,{[`${M}-rtl`]:"rtl"===S}),style:{height:ae,...Y.root,...E,...u},onLoad:te,onError:te},e.createElement(D,{keys:se,component:!1,motionAppear:!0,motionLeave:!0,motionName:`${M}-item-fade`},(t,r)=>{const{item:a,itemKey:n,position:i={},itemIndex:o,key:l,className:m,style:d}=t,{column:h=0}=i,u={"--item-width":`calc((100% + ${J}px) / ${Q})`,insetInlineStart:`calc(var(--item-width) * ${h})`,width:`calc(var(--item-width) - ${J}px)`,top:i.top,position:"absolute"};return e.createElement(he,{prefixCls:M,key:l,item:a,style:{...d,...Y.item,...u},className:s(X.item,m),ref:c(r,e=>F(n,e)),index:o,itemRender:w,column:h,onResize:C?te:null})})))});var fe=class extends C{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:m()})}getOptimisticResult(e){return e.behavior=m(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,t){const{state:r}=e,a=super.createResult(e,t),{isFetching:s,isRefetching:n,isError:i,isRefetchError:o}=a,l=r.fetchMeta?.fetchMore?.direction,c=i&&"forward"===l,m=s&&"forward"===l,u=i&&"backward"===l,p=s&&"backward"===l;return{...a,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:h(t,r.data),hasPreviousPage:d(t,r.data),isFetchNextPageError:c,isFetchingNextPage:m,isFetchPreviousPageError:u,isFetchingPreviousPage:p,isRefetchError:o&&!c&&!u,isRefetching:n&&!m&&!p}}};const ye="_waterfallContainer_1ghlx_1",ve="_masonryItem_1ghlx_6",xe="_imageCard_1ghlx_10",_e="_imageContainer_1ghlx_24",be="_waterfallImage_1ghlx_30",Ne="_imageOverlay_1ghlx_41",we="_overlayBtn_1ghlx_58",ke="_cardContent_1ghlx_78",Ce="_imageTitle_1ghlx_82",je="_authorInfo_1ghlx_92",Se="_authorName_1ghlx_100",Pe="_likesCount_1ghlx_107",Ee="_loadingMore_1ghlx_115",Re="_noMore_1ghlx_122",Oe="_emptyState_1ghlx_129";function Me(t){const r=b.c(53),{filters:a,pageSize:s}=t,n=void 0===s?20:s,i=u(),o=P();let l,c,m;r[0]!==a||r[1]!==n?(l=["images",a,n],r[0]=a,r[1]=n,r[2]=l):l=r[2],r[3]!==a||r[4]!==n||r[5]!==o?(c=e=>{const{pageParam:t}=e,r=void 0===t?1:t;return new Promise((e,t)=>{o.get("/square/posts",{params:{...a,page:r,pageSize:n}}).then(t=>e(t?.data)).catch(e=>t(e))})},r[3]=a,r[4]=n,r[5]=o,r[6]=c):c=r[6],r[7]!==n?(m=(e,t)=>{if(!(e&&e.items&&e.items.length<n))return t.length+1},r[7]=n,r[8]=m):m=r[8];const d=!!a.keyword;let h;r[9]!==l||r[10]!==c||r[11]!==m||r[12]!==d?(h={queryKey:l,queryFn:c,getNextPageParam:m,enabled:d},r[9]=l,r[10]=c,r[11]=m,r[12]=d,r[13]=h):h=r[13];const{data:f,isFetching:y,error:v,fetchNextPage:x,hasNextPage:_,isFetchingNextPage:N}=j(h,fe);let w,k,C;r[14]!==x||r[15]!==_||r[16]!==N?(w=()=>{let e,t=!1;const r=()=>{clearTimeout(e),e=setTimeout(()=>{const e=document.documentElement.scrollTop||document.body.scrollTop;(document.documentElement.scrollHeight||document.body.scrollHeight)-e-(document.documentElement.clientHeight||window.innerHeight)<100&&_&&!N&&!t&&(t=!0,x().finally(()=>{t=!1}))},100)};return window.addEventListener("scroll",r),()=>{window.removeEventListener("scroll",r),clearTimeout(e)}},k=[_,N,x],r[14]=x,r[15]=_,r[16]=N,r[17]=w,r[18]=k):(w=r[17],k=r[18]),e.useEffect(w,k),r[19]!==f?.pages?(C=f?.pages?.flatMap(ze)||[],r[19]=f?.pages,r[20]=C):C=r[20];const S=C;let O;r[21]!==o?(O=async e=>{try{await o.post(`/images/${e}/like`)}catch(t){const e=t;console.error("点赞失败:",e)}},r[21]=o,r[22]=O):O=r[22];const z=O;let $;r[23]!==o?($=async(e,t)=>{try{await o.post("/images/download",{imageUrl:e,filename:t})}catch(r){const e=r;console.error("下载失败:",e)}},r[23]=o,r[24]=$):$=r[24];const D=$;let H;r[25]!==i?(H=e=>{i(`/discover/${e}`,{replace:!1})},r[25]=i,r[26]=H):H=r[26];const q=H;let A;r[27]!==o?(A=async e=>{try{await o.post(`/images/${e}/share`)}catch(t){const e=t;console.error("分享失败:",e)}},r[27]=o,r[28]=A):A=r[28];const T=A;if(v){let e;r[29]===Symbol.for("react.memo_cache_sentinel")?(e={display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},r[29]=e):e=r[29];const t=v?.message;let a;return r[30]!==t?(a=p("div",{style:e,children:g("div",{children:["加载失败: ",t]})}),r[30]=t,r[31]=a):a=r[31],a}let K,U,G,J,V,Q;return r[32]!==D||r[33]!==q||r[34]!==z||r[35]!==T?(K=e=>{const t=e;return p("div",{className:ve,children:g("div",{className:xe,onClick:()=>q(t.postId?.toString()||""),children:[g("div",{className:_e,children:[p("img",{decoding:"async",src:t.preview?.url||"",alt:t.title||"",className:be}),p("div",{className:Ne,children:g(E,{children:[p(R,{type:"text",icon:p(M,{}),className:we,onClick:e=>{e.stopPropagation(),z(t.id)}}),p(R,{type:"text",icon:p(oe,{}),className:we,onClick:e=>{e.stopPropagation(),T(t.id)}}),p(R,{type:"text",icon:p(L,{}),className:we,onClick:e=>{e.stopPropagation(),D(t.image||t.preview?.url||"",`${t.title||"image"}.jpg`)}})]})})]}),g("div",{className:ke,children:[p("div",{className:Ce,children:t.title||""}),g("div",{className:je,children:[p(I,{size:"small",src:t.authorInfo?.avatar||null,icon:p(F,{})}),p("span",{className:Se,children:t.authorInfo?.name||t.author||"未知作者"}),g("span",{className:Pe,children:[p(M,{})," ",t.likesCount||0]})]})]})]})},t.id)},r[32]=D,r[33]=q,r[34]=z,r[35]=T,r[36]=K):K=r[36],r[37]!==S||r[38]!==K?(U=p(ge,{gutter:16,columns:6,items:S,itemRender:K}),r[37]=S,r[38]=K,r[39]=U):U=r[39],r[40]!==N?(G=N&&p("div",{className:Ee,children:p(B,{size:"small",tip:"加载更多..."})}),r[40]=N,r[41]=G):G=r[41],r[42]!==_||r[43]!==S?(J=!_&&S.length>0&&p("div",{className:Re,children:"没有更多数据了"}),r[42]=_,r[43]=S,r[44]=J):J=r[44],r[45]!==S||r[46]!==y?(V=!y&&0===S.length&&p("div",{className:Oe,children:"暂无相关图片，试试其他关键词"}),r[45]=S,r[46]=y,r[47]=V):V=r[47],r[48]!==U||r[49]!==G||r[50]!==J||r[51]!==V?(Q=g("div",{className:ye,children:[U,G,J,V]}),r[48]=U,r[49]=G,r[50]=J,r[51]=V,r[52]=Q):Q=r[52],Q}function ze(e){return e.items}const $e="_layoutContainer_sve49_9",Le="_logo_sve49_56",Ie="_mainContent_sve49_85",Fe="_mainContentCollapsed_sve49_95",De="_discoveryContainer_sve49_100",He="_discoveryHeader_sve49_109",qe="_headerContent_sve49_120",Ae="_searchSection_sve49_131",Be="_headerActions_sve49_139",Te="_categorySection_sve49_146",Ke="_categoryList_sve49_154",Ue="_categoryTag_sve49_164",Ge="_introContainer_sve49_359",Je="_introContent_sve49_370",Ve="_introFeatures_sve49_393",Qe="_featureItem_sve49_402",We="_featureIcon_sve49_418",Xe="_introActions_sve49_440",Ye="_introHint_sve49_447";function Ze(t){const{keyword:r}=t,{filters:a,setFilters:s,setSelectedCategory:n}=N(),[i,o]=e.useState(r||""),[l,c]=e.useState([]),[m,d]=e.useState([]),[h,u]=e.useState(!1),[f,y]=e.useState(-1),v=e.useRef(null),x=P(),_=e.useRef(null),{data:b,isLoading:w}=S({queryKey:["hot"],queryFn:()=>new Promise((e,t)=>{x.get("/square/keywords/hot",{params:{}}).then(t=>{d(t?.data||[]),e(t?.data||[])}).catch(e=>t(e))})});e.useEffect(()=>{const e=localStorage.getItem("searchHistory");if(e)try{c(JSON.parse(e))}catch(t){console.error("Failed to parse search history:",t)}},[]),e.useEffect(()=>{r!==i&&o(r||"")},[r]),e.useEffect(()=>{try{let e=[];e=i.trim()?b.filter(e=>e.keyword.includes(i)):b||[],d(e),(e.length>0||l.length>0)&&u(!0),y(-1)}catch(e){console.error("Failed to update suggestions:",e),d([])}},[i,l.length]);const k=e.useCallback(e=>{localStorage.setItem("searchHistory",JSON.stringify(e)),c(e)},[]),C=e.useCallback(e=>{if(!e.trim())return;const t={id:Date.now().toString(),keyword:e.trim(),timestamp:Date.now()},r=l.filter(e=>e.keyword!==t.keyword),a=[t,...r].slice(0,10);k(a)},[l,k]),j=e.useCallback(e=>{const t=l.filter(t=>t.id!==e);k(t)},[l,k]),E=e.useCallback(()=>{k([])},[k]),R=e.useCallback(e=>{const t=e||i;t.trim()&&(s({...a,keyword:t}),C(t),u(!1),o(t))},[a,i,s,C]),O=e.useCallback(()=>{o(""),s(void 0),n(""),u(!!l.length||!!m.length),y(-1),_.current?.focus()},[l.length,m.length,s,n]),M=e.useCallback(e=>{o(e.target.value)},[]),z=e.useCallback(e=>{R(e)},[R]),$=e.useCallback(e=>{const t=l.length+m.length;switch(e.key){case"ArrowDown":e.preventDefault(),y(e=>e<t-1?e+1:0);break;case"ArrowUp":e.preventDefault(),y(e=>e>0?e-1:t-1);break;case"Enter":if(e.preventDefault(),f>=0){const e=[...l,...m][f];e&&R(e.keyword)}else R();break;case"Escape":e.preventDefault(),u(!1),y(-1)}},[f,l,m,R]);e.useEffect(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&(u(!1),y(-1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const L=e.useCallback(()=>[...l,...m],[l,m]);return g("div",{ref:v,className:"relative w-full max-w-2xl mx-auto",children:[g("div",{className:"flex items-center bg-white rounded-full shadow-sm border border-gray-100",children:[p("div",{className:"ml-4 text-gray-400",children:p(T,{})}),p("input",{ref:_,type:"text",placeholder:"搜索你喜欢的图片、素材、灵感...",className:"flex-1 px-4 py-3 text-gray-800 bg-transparent border-none outline-none placeholder-gray-400",value:i,onChange:M,onKeyDown:$,onFocus:()=>u(!!l.length||!!m.length)}),i&&p("button",{onClick:O,className:"mr-2 text-gray-400 hover:text-gray-600 transition-colors",children:p(K,{})}),p("button",{onClick:()=>R(),className:"mr-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200 transition-colors",children:"搜索"})]}),h&&(L().length>0||l.length>0)&&g("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-100 rounded-xl shadow-md overflow-hidden z-50",children:[l.length>0&&g("div",{className:"p-2",children:[g("div",{className:"flex items-center justify-between px-3 py-2",children:[g("div",{className:"flex items-center text-gray-600 text-sm font-medium",children:[p(ae,{className:"mr-2 text-gray-500"}),"搜索历史"]}),p("button",{onClick:E,className:"text-gray-500 text-xs hover:text-gray-700 transition-colors",children:"清除"})]}),l.map((e,t)=>g("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer rounded-lg transition-colors "+(t===f?"bg-gray-100":"hover:bg-gray-50"),onClick:()=>z(e.keyword),children:[g("div",{className:"flex items-center text-gray-700",children:[p(Z,{className:"mr-3 text-gray-500 text-xs"}),p("span",{children:e.keyword})]}),p("button",{onClick:t=>{t.stopPropagation(),j(e.id)},className:"text-gray-400 hover:text-gray-600 transition-colors text-xs",children:p(K,{})})]},e.id))]}),m.length>0&&g("div",{className:"p-2 border-t border-gray-100",children:[g("div",{className:"flex items-center px-3 py-2 text-gray-600 text-sm font-medium",children:[p(T,{className:"mr-2 text-gray-500"}),"搜索推荐"]}),p("div",{className:"flex flex-wrap gap-2 px-3 py-2",children:m.map((e,t)=>{const r=t+l.length===f;return g("div",{className:"inline-flex items-center cursor-pointer rounded-full px-4 py-1.5 text-sm transition-all "+(r?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-50 text-gray-700 border border-gray-200 hover:bg-gray-100"),onClick:()=>z(e.keyword),children:[p(T,{className:"mr-2 text-xs"}),p("span",{children:e.keyword}),e.count&&g("span",{className:"ml-2 text-xs opacity-70",children:["(",e.count,")"]})]},e.id)})})]})]})]})}function et(){const t=b.c(60),r=u(),[a,s]=e.useState(!1),{data:n,error:i}=(()=>{const e=b.c(1);let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t={queryKey:["categories"],queryFn:O.getCategories,staleTime:18e5},e[0]=t):t=e[0],S(t)})();let o;t[0]!==n?(o=void 0===n?[]:n,t[0]=n,t[1]=o):o=t[1];const l=o,{selectedCategory:c,filters:m,collapsed:d,setSelectedCategory:h,setFilters:f}=N();let y,v,x;t[2]!==a?(y=()=>{const e=()=>{a&&s(!1)};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},v=[a],t[2]=a,t[3]=y,t[4]=v):(y=t[3],v=t[4]),e.useEffect(y,v),t[5]===Symbol.for("react.memo_cache_sentinel")?(x=[{key:"profile",label:"个人主页"},{key:"collections",label:"我的采集"},{key:"likes",label:"我喜欢的"},{key:"settings",label:"设置"}],t[5]=x):x=t[5];const _=x;let C;t[6]===Symbol.for("react.memo_cache_sentinel")?(C={mask:{backgroundColor:"rgba(247, 249, 250, 0.98)"},container:{backgroundColor:"transparent",boxShadow:"0 0 0 transparent"}},t[6]=C):C=t[6];const j=C;if(i){let e;t[7]===Symbol.for("react.memo_cache_sentinel")?(e={display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},t[7]=e):e=t[7];const r=i?.message;let a;return t[8]!==r?(a=p("div",{style:e,children:g("div",{children:["加载失败: ",r]})}),t[8]=r,t[9]=a):a=t[9],a}let P;t[10]!==d?(P=p(w,{collapsed:d}),t[10]=d,t[11]=P):P=t[11];const E=`${Ie} ${d?Fe:""}`;let D;t[12]===Symbol.for("react.memo_cache_sentinel")?(D=p("div",{className:Le,children:p("h2",{children:"Paint"})}),t[12]=D):D=t[12];const H=m?.keyword;let q,A,B,T,K,W,X,Y,Z,ee,te,re,ae,se,ne,ie,oe,le;if(t[13]!==H?(q=p("div",{className:Ae,children:p(Ze,{keyword:H})}),t[13]=H,t[14]=q):q=t[14],t[15]===Symbol.for("react.memo_cache_sentinel")?(A=p(U,{}),t[15]=A):A=t[15],t[16]!==r?(B=p(R,{type:"primary",icon:A,onClick:()=>r("/ai-paint"),children:"创作"}),t[16]=r,t[17]=B):B=t[17],t[18]===Symbol.for("react.memo_cache_sentinel")?(T={items:_},t[18]=T):T=t[18],t[19]===Symbol.for("react.memo_cache_sentinel")?(K=p(G,{menu:T,placement:"bottomRight",children:p(I,{size:"large",icon:p(F,{}),style:{cursor:"pointer"}})}),t[19]=K):K=t[19],t[20]!==B?(W=g("div",{className:Be,children:[B,K]}),t[20]=B,t[21]=W):W=t[21],t[22]!==q||t[23]!==W?(X=p("div",{className:He,children:g("div",{className:qe,children:[D,q,W]})}),t[22]=q,t[23]=W,t[24]=X):X=t[24],t[25]!==l||t[26]!==m||t[27]!==f||t[28]!==h){let e;t[30]!==m||t[31]!==f||t[32]!==h?(e=e=>p(z,{color:"default",className:Ue,onClick:()=>{f({...m,keyword:e}),h(e)},children:e},e),t[30]=m,t[31]=f,t[32]=h,t[33]=e):e=t[33],Y=l.map(e),t[25]=l,t[26]=m,t[27]=f,t[28]=h,t[29]=Y}else Y=t[29];return t[34]!==Y?(Z=p("div",{className:Te,children:p("div",{className:Ke,children:Y})}),t[34]=Y,t[35]=Z):Z=t[35],t[36]!==l||t[37]!==m||t[38]!==r||t[39]!==c||t[40]!==f||t[41]!==h?(ee=m?.keyword||c?p(Me,{filters:m}):p("div",{className:Ge,children:g("div",{className:Je,children:[p("h1",{children:"探索无限创意世界"}),p("p",{children:"在 Paint，发现来自全球创作者的精彩作品，涵盖数字艺术、插画、设计、摄影等多种风格和主题"}),g("div",{className:Ve,children:[g("div",{className:Qe,children:[p("div",{className:We,children:p(J,{})}),p("h3",{children:"海量优质作品"}),p("p",{children:"浏览来自全球数百万创作者的高质量作品，从热门趋势到小众创意"})]}),g("div",{className:Qe,children:[p("div",{className:We,children:p(de,{})}),p("h3",{children:"智能推荐系统"}),p("p",{children:"基于你的兴趣和行为，为你推荐最符合你口味的创意作品"})]}),g("div",{className:Qe,children:[p("div",{className:We,children:p(M,{})}),p("h3",{children:"互动交流社区"}),p("p",{children:"点赞、评论、分享你喜欢的作品，与创作者和其他爱好者交流"})]}),g("div",{className:Qe,children:[p("div",{className:We,children:p(L,{})}),p("h3",{children:"免费资源下载"}),p("p",{children:"访问海量免费可商用资源，助力你的创意项目"})]}),g("div",{className:Qe,children:[p("div",{className:We,children:p(k,{})}),p("h3",{children:"个性化主页"}),p("p",{children:"创建专属个人主页，展示你的作品集和创作历程"})]}),g("div",{className:Qe,children:[p("div",{className:We,children:p(V,{})}),p("h3",{children:"灵活创作工具"}),p("p",{children:"使用强大的创作工具，实现你的创意想法"})]})]}),g("div",{className:Xe,children:[p(R,{type:"primary",size:"large",onClick:()=>r("/ai-paint"),children:"立即开始创作"}),p(R,{type:"default",size:"large",onClick:()=>{const e=l[Math.floor(Math.random()*l.length)];f({...m,keyword:e}),h(e)},children:"随机探索"}),p("div",{className:Ye,children:p("p",{children:"或从上方分类中选择一个主题开始探索"})})]})]})}),t[36]=l,t[37]=m,t[38]=r,t[39]=c,t[40]=f,t[41]=h,t[42]=ee):ee=t[42],t[43]===Symbol.for("react.memo_cache_sentinel")?(te={enabled:!0,blur:!1},t[43]=te):te=t[43],t[44]===Symbol.for("react.memo_cache_sentinel")?(re=()=>s(!1),ae=()=>s(!1),t[44]=re,t[45]=ae):(re=t[44],ae=t[45]),t[46]===Symbol.for("react.memo_cache_sentinel")?(se=p($,{onClose:()=>s(!1)}),t[46]=se):se=t[46],t[47]!==a?(ne=p(Q,{footer:null,styles:j,open:a,maskClosable:!0,mask:te,width:"auto",onOk:re,onCancel:ae,children:se}),t[47]=a,t[48]=ne):ne=t[48],t[49]!==X||t[50]!==Z||t[51]!==ee||t[52]!==ne?(ie=g("div",{className:De,children:[X,Z,ee,ne]}),t[49]=X,t[50]=Z,t[51]=ee,t[52]=ne,t[53]=ie):ie=t[53],t[54]!==ie||t[55]!==E?(oe=p("div",{className:E,children:ie}),t[54]=ie,t[55]=E,t[56]=oe):oe=t[56],t[57]!==oe||t[58]!==P?(le=g("div",{className:$e,children:[P,oe]}),t[57]=oe,t[58]=P,t[59]=le):le=t[59],le}export{et as default};
